$(document).ready(function() {
  //-------------------------------------------------------------------------
  // BOOTSTRAP
  //-------------------------------------------------------------------------

  $('[rel=tooltip]').tooltip({
    'placement' : 'bottom'
  });

  $('.dropdown-menu input, .dropdown-menu label').click(function(e) {
    e.stopPropagation();
  });

  // enable masonry plugin
  $(function(){
    $('#charts-content').masonry({
      // options
      itemSelector : '.chart',
      animationOptions: {
        duration: 1000
      }
    });
  });

  //transformar botões em tablets e smartphones
  function updateButtons() {
    if ($(window).width() < 940) {
      $('#btn-charts').addClass('btn-block');
      $('#btn-map').addClass('btn-block');
    } else {
      $('#btn-charts').removeClass('btn-block');
      $('#btn-map').removeClass('btn-block');
    }
  }
  updateButtons();

  // configuração dos butão mapa
  $('#btn-map').click(function() {
    $(this).prop('disabled', true);
    $('#btn-charts').prop('disabled', false);
    $('.dash').hide();
    $('.nav-collapse').collapse('hide');
  });

  // configuração dos butão de gráficos
  $('#btn-charts').click(function() {
    $(this).prop('disabled', true);
    $('#btn-map').prop('disabled', false);
    $('.dash').show();
    $('.nav-collapse').collapse('hide');
  });

  var sidebarMapHidden = 1;
  $('#sidebar-map').toggleClass('sidebar-map-hidden', 500);
  $('#sidebar-map-btn').click(function() {
    $('#sidebar-map').toggleClass('sidebar-map-hidden', 500);
    if (sidebarMapHidden) {
      $(this).children('i').prop('class', 'icon-arrow-left');
      sidebarMapHidden--;
    } else {
      $(this).children('i').prop('class', 'icon-arrow-right');
      sidebarMapHidden++;
    }
  });

  var sidebarDashHidden = 1;
  $('#sidebar-dash').toggleClass('sidebar-dash-hidden', 500);
  $('#sidebar-dash-btn').click(function() {
    $('#sidebar-dash').toggleClass('sidebar-dash-hidden', 500);
    if (sidebarDashHidden) {
      $(this).children('i').prop('class', 'icon-arrow-left');
      sidebarDashHidden--;
    } else {
      $(this).children('i').prop('class', 'icon-arrow-right');
      sidebarDashHidden++;
    }
  });

  // configurações da tela de login
  var progressValue = 0;
  $("#progress").show('fade', {}, 300);
  $("#loading_logo").show('fade', {}, 1000);
  // animar barra de progresso
  var loading = setInterval(function() {
    progressValue += 50;
    $('#progressbar').css({
      width : progressValue + '%'
    });
    if (progressValue >= 100) {
      window.clearInterval(loading);
      $('#btn-map').prop('disabled', false);
      $('#btn-charts').prop('disabled', true);
      $('.loading').fadeOut(700);
      $('#navbar').slideDown(300);
      reloadCharts();
    }
  }, 1000);

  // Detect whether device supports orientationchange event, otherwise fall back to
  // the resize event.
  var supportsOrientationChange = "onorientationchange" in window,
  orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";

  // detectar mudança na resolução ou orientação
  window.addEventListener(orientationEvent, function() {
    updateButtons();
  }, false);

  //-------------------------------------------------------------------------
  // CUSTOM FUNCTIONS
  //-------------------------------------------------------------------------

//change the case to Letter case, ex: helmuth saatkamp to Helmuth Saatkamp
  String.prototype.toProperCase = function() {
    return this.replace(/\w\S*/g, function(txt) {
      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
    });
  };

  // precionar o enter ativa busca
  $(function() {
    $('input').keydown(function(e) {
      if (e.keyCode == 13) {
        setTimeout(function() { $('#submit').click(); }, 0);
      }
    });
  });

  //round numbers function
  function roundNumber(number, digits) {
    var multiple = Math.pow(10, digits);
    var rndedNum = Math.round(number * multiple) / multiple;
    return rndedNum;
  }

});
